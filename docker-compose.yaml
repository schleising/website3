version: "3.11"

services:
  nginx:
    build: nginx
    ports:
      - 8010:80
      - 8011:443
    depends_on:
      - fastapi
    volumes:
      - ./website/static:/static:ro
      - socket_volume:/socket:rw
    # restart: always

  fastapi:
    build: fastapi
    volumes:
      - ./website:/app:ro
      - socket_volume:/socket:rw
      - nginx_conf:/etc/nginx:rw
      - letsencrypt_conf:/etc/letsencrypt:rw
    # restart: always

volumes:
  socket_volume:
  nginx_conf:
  letsencrypt_conf:
